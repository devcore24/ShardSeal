# Local example config
address: ":8080"
# One or more data directories (created if missing)
dataDirs:
  - "./data"

# Authentication (optional)
# Auth is disabled by default ("none"). To enable SigV4 verification, set:
#   authMode: "sigv4"
# Provide static credentials here or via environment variable SHARDSEAL_ACCESS_KEYS.
authMode: "none"  # "none" or "sigv4"

# accessKeys define static credentials when using SigV4.
# Uncomment and provide at least one entry to enable static auth via config file.
# accessKeys:
#   - accessKey: "AKIAEXAMPLE"
#     secretKey: "secret"
#     user: "local"

# Tracing (optional)
# OpenTelemetry tracing is disabled by default. To enable, set enabled: true and configure endpoint/protocol.
# You can also override via env:
#   SHARDSEAL_TRACING_ENABLED=true
#   SHARDSEAL_TRACING_ENDPOINT=localhost:4317   # for gRPC (default)
#   SHARDSEAL_TRACING_PROTOCOL=grpc             # or "http"
#   SHARDSEAL_TRACING_SAMPLE=0.1                # 10% sampling
#   SHARDSEAL_TRACING_SERVICE=shardseal-local
tracing:
  enabled: false
  # For gRPC, typical endpoint is "localhost:4317"; for HTTP "localhost:4318"
  endpoint: ""
  # "grpc" (default) or "http"
  protocol: "grpc"
  # 0.0 - 1.0 sampling ratio. Use 1.0 for debugging only.
  sampleRatio: 0.0
  # Optional override for service.name resource attribute
  serviceName: "shardseal"

  # When true, emit s3.key_hash (sha256 of key, first 8 bytes hex) on spans.
  # Env override: SHARDSEAL_TRACING_KEY_HASH=true
  keyHashEnabled: false

# Sealed I/O (experimental)
# ShardSeal v1 sealed object format controls. Disabled by default.
# Environment overrides:
#   SHARDSEAL_SEALED_ENABLED=true
#   SHARDSEAL_SEALED_VERIFY_ON_READ=true
sealed:
  enabled: false
  verifyOnRead: false

# Optional Admin API (read-only endpoints and admin tools)
# Uncomment to enable a separate admin listener (e.g., for /admin/health, /admin/version, GC endpoint)
# adminAddress: ":9090"

# Multipart GC (optional)
# Periodically garbage-collect stale multipart uploads from the internal ".multipart" staging bucket
# and abort the respective uploads in metadata (best-effort). Disabled by default.
# Environment overrides:
#   SHARDSEAL_GC_ENABLED=true
#   SHARDSEAL_GC_INTERVAL=15m
#   SHARDSEAL_GC_OLDER_THAN=24h
gc:
  enabled: false
  interval: "15m"
  olderThan: "24h"


# Admin OIDC (optional)
# Protects the Admin API with OIDC/OAuth2 Bearer tokens. Disabled by default.
# Configure either issuer+clientID (preferred) or jwksURL+audience.
# Environment overrides:
#   SHARDSEAL_OIDC_ENABLED=true
#   SHARDSEAL_OIDC_ISSUER=https://auth.example.com/realms/dev
#   SHARDSEAL_OIDC_CLIENT_ID=shardseal-admin
#   SHARDSEAL_OIDC_AUDIENCE=shardseal-admin-api        # optional, overrides clientID
#   SHARDSEAL_OIDC_JWKS_URL=https://auth.example.com/realms/dev/protocol/openid-connect/certs
#   SHARDSEAL_OIDC_ALLOW_UNAUTH_HEALTH=true         # optional: allow unauthenticated /admin/health
#   SHARDSEAL_OIDC_ALLOW_UNAUTH_VERSION=true        # optional: allow unauthenticated /admin/version
oidc:
  enabled: false
  issuer: ""
  clientID: ""
  audience: ""
  jwksURL: ""
  allowUnauthHealth: false
  allowUnauthVersion: false


# Request size limits (optional)
# Configure S3 request size limits in bytes. Zero or missing values use defaults.
# Environment overrides:
#   SHARDSEAL_LIMIT_SINGLE_PUT_MAX_BYTES=5368709120
#   SHARDSEAL_LIMIT_MIN_MULTIPART_PART_SIZE=5242880
limits:
  singlePutMaxBytes: 5368709120    # 5 GiB cap for single PUT
  minMultipartPartSize: 5242880    # 5 MiB minimum for non-final multipart parts


# Integrity Scrubber (experimental)
# Background integrity scrubbing verifies sealed header/footer CRCs and compares footer content-hash to the manifest.
# When payload verification is enabled, the scrubber also recomputes sha256(payload). By default, payload verification
# inherits sealed.verifyOnRead; set scrubber.verifyPayload to override explicitly.
# Environment overrides:
#   SHARDSEAL_SCRUBBER_ENABLED=true
#   SHARDSEAL_SCRUBBER_INTERVAL=1h
#   SHARDSEAL_SCRUBBER_CONCURRENCY=2
#   SHARDSEAL_SCRUBBER_VERIFY_PAYLOAD=true   # overrides inheritance from sealed.verifyOnRead
scrubber:
  enabled: false
  interval: "1h"
  concurrency: 1
  # verifyPayload: true   # uncomment to force payload re-hash verification (true/false). When omitted, inherits sealed.verifyOnRead.
